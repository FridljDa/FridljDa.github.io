# Repository Instructions for Cursor

## Project Overview
This is a personal website built with Astro, featuring an AI chat functionality powered by Google Gemini API with server-side rendering.

## Tech Stack
- **Framework**: Astro with SSR (Server-Side Rendering)
- **Styling**: Tailwind CSS
- **Content**: MDX with math support (KaTeX via remark-math and rehype-katex)
- **Testing**: Playwright
- **AI Integration**: Google Gemini API (via @google/generative-ai)
- **Runtime**: Node.js with @astrojs/node adapter

## Project Structure
- `src/components/` - Astro and React components (Biography, Experience, BlogPostCard, Chat, etc.)
- `src/pages/` - Astro pages and API routes
  - `src/pages/api/chat.ts` - Chat API endpoint for Gemini integration
- `src/data/` - TypeScript data files (site config, publications, experience)
- `src/content/blog/` - Blog posts as MDX files (content collections)
- `src/layouts/` - Layout components
- `src/styles/` - Global CSS
- `public/` - Static assets (images, uploads)
- `tests/` - Playwright test files

## Branch Management

### Creating New Branches
- **Before creating new branches**: Always fetch the latest master branch first:
  ```bash
  git fetch origin master
  git checkout master
  git pull origin master
  git checkout -b your-new-branch-name
  ```
  This ensures new branches are based on the most recent master branch.

## Local Development

### Setup
- The dev server runs on `http://localhost:4321`
- Requires `GEMINI_API_KEY` environment variable for chat functionality
- Tests require the dev server to be running first

### Development Workflow
- Update data files in `src/data/` for site-wide changes
- Add blog posts to `src/content/blog/` with proper frontmatter
- Use Astro's component pattern for reusable UI elements
- Maintain consistency with existing Tailwind styling patterns
- Chat component is a React component that uses client-side hydration

### Resume PDF
- **Artifact**: `public/uploads/resume.pdf` - Synced from the [CV_management](https://github.com/FridljDa/CV_management) repository (that repo renders the PDF from YAML and pushes it here via PR).
- **Chat API usage**: `src/pages/api/chat.ts` uses `generateHomePageMarkdown()` which includes CV/resume information from the home page content (biography, experience, publications).

### Testing Changes
To test changes, you can:
1. Run `npm test` locally (ensure dev server is running first)
2. Commit, push, and verify on production (https://danielfridljand.de) or your Coolify preview

### Running Locally
1. Set environment variable: `export GEMINI_API_KEY=your_key_here` (or create `.env` file)
2. Start Astro dev server: `npm run dev`
3. Run tests: `npm test` (requires dev server running)

## Production

### Deployment
- Production is deployed with Coolify on Hetzner (Docker). See [DEPLOYMENT.md](DEPLOYMENT.md).
- Live site URL: **https://danielfridljand.de/**

### Production Debugging
- Use Coolify dashboard for logs, restarts, and env vars.
- Health check: `GET https://danielfridljand.de/api/health` should return 200.


